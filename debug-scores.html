<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ†æ•°è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 { color: #333; }
        h2 { color: #666; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #007bff;
            color: white;
        }
        tr:nth-child(even) {
            background: #f9f9f9;
        }
        .score-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
        }
        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.5s;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .alert {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
        }
        .dimension-display {
            display: inline-block;
            margin: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            min-width: 150px;
        }
        .dimension-label {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }
        .dimension-S { border-left: 4px solid #f48771; }
        .dimension-A { border-left: 4px solid #4ec9b0; }
        .dimension-G { border-left: 4px solid #dcdcaa; }
        .dimension-R { border-left: 4px solid #569cd6; }
        .dimension-E { border-left: 4px solid #c586c0; }
    </style>
</head>
<body>
    <h1>ğŸ” ç†æƒ³ä¼´ä¾£æµ‹è¯• - åˆ†æ•°è°ƒè¯•å·¥å…·</h1>

    <div class="container">
        <h2>æµ‹è¯•æ¨¡å¼é€‰æ‹©</h2>
        <button class="btn" onclick="testAllA()">å…¨éƒ¨é€‰A</button>
        <button class="btn" onclick="testAllB()">å…¨éƒ¨é€‰B</button>
        <button class="btn" onclick="testAllC()">å…¨éƒ¨é€‰C</button>
        <button class="btn" onclick="testAllD()">å…¨éƒ¨é€‰D</button>
        <button class="btn" onclick="testRandom()">éšæœºé€‰æ‹©</button>
        <button class="btn" onclick="testMixed()">æ··åˆé€‰æ‹©</button>
    </div>

    <div class="container">
        <h2>åŸå§‹åˆ†æ•° (Raw Scores)</h2>
        <div id="rawScores"></div>
    </div>

    <div class="container">
        <h2>å½’ä¸€åŒ–åˆ†æ•° (Normalized Scores 0-100)</h2>
        <div id="normalizedScores"></div>
    </div>

    <div class="container">
        <h2>ä¸å„ä¼´ä¾£ç±»å‹çš„é€‚é…åº¦</h2>
        <div id="compatibility"></div>
    </div>

    <div class="container">
        <h2>é—®é¢˜åˆ†æ</h2>
        <div id="analysis"></div>
    </div>

    <script>
        // æ¨¡æ‹Ÿé¢˜ç›®æ•°æ® (ç®€åŒ–ç‰ˆ,æ¯é¢˜4ä¸ªé€‰é¡¹)
        const questionCategories = [];
        for (let i = 1; i <= 40; i++) {
            const category = ['S','A','G','R','E'][(i-1) % 5];
            questionCategories.push(category);
        }

        // æ¨¡æ‹Ÿé€‰é¡¹åˆ†æ•°
        const optionScores = {
            'A': { S: 1, A: 1, G: 1, R: 1, E: 1 },
            'B': { S: 2, A: 2, G: 2, R: 2, E: 2 },
            'C': { S: 3, A: 3, G: 3, R: 3, E: 3 },
            'D': { S: 4, A: 4, G: 4, R: 4, E: 4 }
        };

        // å®é™…çš„é¢˜ç›®åˆ†æ•°é…ç½® (ä»questions.tsæå–çš„çœŸå®æ•°æ®)
        const realQuestions = [
            // é¢˜ç›®1 - Sç»´åº¦
            { id: 1, category: 'S', options: [
                { id: 'A', scores: { S: 1, A: 1 } },
                { id: 'B', scores: { S: 2, E: 1 } },
                { id: 'C', scores: { A: 2 } },
                { id: 'D', scores: { S: 3, E: 1 } }
            ]},
            // é¢˜ç›®2 - Sç»´åº¦
            { id: 2, category: 'S', options: [
                { id: 'A', scores: { A: 2 } },
                { id: 'B', scores: { S: 3 } },
                { id: 'C', scores: { S: 2, E: 1 } },
                { id: 'D', scores: { S: 2 } }
            ]},
            // é¢˜ç›®3 - Sç»´åº¦
            { id: 3, category: 'S', options: [
                { id: 'A', scores: { A: 1 } },
                { id: 'B', scores: { S: 1 } },
                { id: 'C', scores: { S: 3, R: 1 } },
                { id: 'D', scores: { S: 2 } }
            ]}
            // ... å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šé¢˜ç›®
        ];

        // ä¼´ä¾£ç±»å‹
        const partnerTypes = [
            { name: 'ç¨³å®šæ¸¯æ¹¾å‹', idealProfile: { S: 85, A: 30, G: 40, R: 80, E: 35 } },
            { name: 'å¹¶è‚©æ‰“æ‹¼å‹', idealProfile: { S: 45, A: 45, G: 90, R: 65, E: 30 } },
            { name: 'æ»‹å…»ç…§é¡¾å‹', idealProfile: { S: 90, A: 20, G: 30, R: 25, E: 85 } },
            { name: 'çµé­‚å¯¹è°ˆå‹', idealProfile: { S: 45, A: 80, G: 60, R: 20, E: 90 } },
            { name: 'è‡ªç”±åŒä¼´å‹', idealProfile: { S: 25, A: 90, G: 45, R: 30, E: 30 } },
            { name: 'ç†æ€§æ‹æ¡£å‹', idealProfile: { S: 15, A: 40, G: 60, R: 90, E: 5 } },
            { name: 'ç°å®é è°±å‹', idealProfile: { S: 30, A: 30, G: 80, R: 90, E: 20 } },
            { name: 'æƒ…ç»ªå…±æŒ¯å‹', idealProfile: { S: 80, A: 25, G: 25, R: 15, E: 90 } }
        ];

        // è®¡ç®—åŸå§‹åˆ†æ•°
        function calculateRawScores(answers) {
            const scores = { S: 0, A: 0, G: 0, R: 0, E: 0 };

            // ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬: æ¯é¢˜æ ¹æ®é€‰æ‹©çš„é€‰é¡¹åŠ åˆ†
            for (let i = 0; i < 40; i++) {
                const option = answers[i];
                const category = ['S','A','G','R','E'][i % 5];
                const baseScore = { 'A': 1, 'B': 2, 'C': 3, 'D': 4 }[option];

                // ä¸»è¦ç»´åº¦åŠ åˆ†
                scores[category] += baseScore;

                // æ¨¡æ‹Ÿè·¨ç»´åº¦åŠ åˆ† (ç®€åŒ–)
                if (category === 'S' && option === 'A') scores.A += 1;
                if (category === 'S' && (option === 'B' || option === 'D')) scores.E += 1;
                if (category === 'S' && option === 'C') scores.R += 1;
            }

            return scores;
        }

        // å½’ä¸€åŒ–å‡½æ•°
        function normalizeScores(scores) {
            const normalized = { S: 0, A: 0, G: 0, R: 0, E: 0 };
            Object.keys(scores).forEach(key => {
                const raw = scores[key];
                let norm;
                if (raw <= 10) norm = raw * 3;
                else if (raw <= 20) norm = 30 + (raw - 10) * 3;
                else if (raw <= 30) norm = 60 + (raw - 20) * 2.8;
                else if (raw <= 35) norm = 88 + (raw - 30) * 1.4;
                else norm = Math.min(100, 95 + (raw - 35) * 0.5);
                normalized[key] = Math.max(0, Math.min(100, Math.round(norm)));
            });
            return normalized;
        }

        // è®¡ç®—å·®å¼‚
        function calculateDifference(profile1, profile2) {
            const dims = ['S', 'A', 'G', 'R', 'E'];
            let total = 0;
            dims.forEach(d => {
                total += Math.abs(profile1[d] - profile2[d]);
            });
            return total / dims.length;
        }

        // è®¡ç®—é€‚é…åº¦
        function calculateCompatibility(difference) {
            if (difference <= 15) return Math.round(90 + (15 - difference) * 0.67);
            else if (difference <= 25) return Math.round(70 + (25 - difference) * 2);
            else if (difference <= 35) return Math.round(50 + (35 - difference) * 2);
            else if (difference <= 45) return Math.round(30 + (45 - difference) * 2);
            else if (difference <= 55) return Math.round(10 + (55 - difference) * 2);
            else return Math.max(0, Math.round(10 - (difference - 55) * 0.5));
        }

        // æ˜¾ç¤ºåˆ†æ•°
        function displayScores(raw, normalized) {
            const dims = ['S', 'A', 'G', 'R', 'E'];
            const dimNames = {
                S: 'æƒ…æ„Ÿå®‰å…¨æ„Ÿ (S)',
                A: 'è‡ªä¸»ç©ºé—´ (A)',
                G: 'å…±åŒæˆé•¿ (G)',
                R: 'ç°å®åŠ¡å® (R)',
                E: 'æƒ…ç»ªå…±é¸£ (E)'
            };

            let rawHtml = '';
            let normHtml = '';

            dims.forEach(dim => {
                rawHtml += `
                    <div class="dimension-display dimension-${dim}">
                        <div class="dimension-label">${dim}</div>
                        <div style="font-size:24px;color:#333;">${raw[dim]}</div>
                        <div style="font-size:12px;color:#666;">${dimNames[dim]}</div>
                    </div>
                `;

                normHtml += `
                    <div class="dimension-display dimension-${dim}">
                        <div class="dimension-label">${dim}</div>
                        <div style="font-size:24px;color:#333;">${normalized[dim]}</div>
                        <div class="score-bar">
                            <div class="score-fill" style="width:${normalized[dim]}%"></div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('rawScores').innerHTML = rawHtml;
            document.getElementById('normalizedScores').innerHTML = normHtml;
        }

        // æ˜¾ç¤ºé€‚é…åº¦
        function displayCompatibility(userProfile) {
            let html = '<table><tr><th>ä¼´ä¾£ç±»å‹</th><th>å·®å¼‚åº¦</th><th>é€‚é…åº¦</th><th>æ’å</th></tr>';

            const results = partnerTypes.map(type => {
                const diff = calculateDifference(userProfile, type.idealProfile);
                const compat = calculateCompatibility(diff);
                return { name: type.name, diff, compatibility: compat };
            });

            results.sort((a, b) => b.compatibility - a.compatibility);

            results.forEach((r, i) => {
                const color = i === 0 ? '#4CAF50' : (i === results.length - 1 ? '#f44336' : '#333');
                html += `
                    <tr style="color:${color};font-weight:${i === 0 || i === results.length - 1 ? 'bold' : 'normal'}">
                        <td>${r.name}</td>
                        <td>${r.diff.toFixed(1)}</td>
                        <td>${r.compatibility}%</td>
                        <td>${i + 1}</td>
                    </tr>
                `;
            });

            html += '</table>';
            document.getElementById('compatibility').innerHTML = html;
        }

        // åˆ†æé—®é¢˜
        function analyzeResults(userProfile) {
            let html = '';

            // æ‰¾å‡ºæœ€é«˜å’Œæœ€ä½ç»´åº¦
            const dims = ['S', 'A', 'G', 'R', 'E'];
            const sorted = dims.map(d => ({ dim: d, score: userProfile[d] }))
                              .sort((a, b) => b.score - a.score);

            html += `<div class="alert alert-warning">
                <strong>âš ï¸ å…³é”®å‘ç°:</strong><br>
                æœ€é«˜ç»´åº¦: ${sorted[0].dim} (${sorted[0].score}åˆ†)<br>
                æœ€ä½ç»´åº¦: ${sorted[sorted.length-1].dim} (${sorted[sorted.length-1].score}åˆ†)<br>
                åˆ†æ•°æå·®: ${sorted[0].score - sorted[sorted.length-1].score}åˆ†
            </div>`;

            // é—®é¢˜åˆ†æ
            const avgScore = sorted.reduce((sum, s) => sum + s.score, 0) / 5;
            html += `<div class="alert alert-warning">
                <strong>ğŸ” é—®é¢˜è¯Šæ–­:</strong><br>
                å¹³å‡åˆ†æ•°: ${avgScore.toFixed(1)}åˆ†<br>
            `;

            if (avgScore > 70) {
                html += `âš ï¸ <strong>æ‰€æœ‰ç»´åº¦åˆ†æ•°éƒ½åé«˜!</strong> è¿™ä¼šå¯¼è‡´æ‰€æœ‰ç±»å‹é€‚é…åº¦éƒ½æ¥è¿‘,æ— æ³•æœ‰æ•ˆåŒºåˆ†ã€‚<br>`;
                html += `<strong>å»ºè®®:</strong> éœ€è¦è°ƒæ•´å½’ä¸€åŒ–ç®—æ³•,æˆ–è€…é¢˜ç›®é€‰é¡¹éœ€è¦æœ‰ä¸åŒçš„åˆ†æ•°æ–¹å‘ã€‚`;
            } else if (avgScore < 40) {
                html += `âš ï¸ <strong>æ‰€æœ‰ç»´åº¦åˆ†æ•°éƒ½åä½!</strong><br>`;
            } else {
                html += `âœ… åˆ†æ•°åˆ†å¸ƒè¾ƒä¸ºåˆç†ã€‚`;
            }

            html += `</div>`;

            document.getElementById('analysis').innerHTML = html;
        }

        // æµ‹è¯•å‡½æ•°
        function runTest(answers) {
            const raw = calculateRawScores(answers);
            const normalized = normalizeScores(raw);
            displayScores(raw, normalized);
            displayCompatibility(normalized);
            analyzeResults(normalized);
        }

        function testAllA() {
            const answers = new Array(40).fill('A');
            runTest(answers);
        }

        function testAllB() {
            const answers = new Array(40).fill('B');
            runTest(answers);
        }

        function testAllC() {
            const answers = new Array(40).fill('C');
            runTest(answers);
        }

        function testAllD() {
            const answers = new Array(40).fill('D');
            runTest(answers);
        }

        function testRandom() {
            const options = ['A', 'B', 'C', 'D'];
            const answers = Array.from({length: 40}, () => options[Math.floor(Math.random() * 4)]);
            runTest(answers);
        }

        function testMixed() {
            // æ¨¡æ‹ŸåSç»´åº¦çš„é€‰æ‹©
            const answers = [];
            for (let i = 0; i < 40; i++) {
                const category = ['S','A','G','R','E'][i % 5];
                if (category === 'S') {
                    answers.push('D'); // Sç»´åº¦é€‰é«˜åˆ†
                } else if (category === 'E') {
                    answers.push('C'); // Eç»´åº¦é€‰ä¸­é«˜åˆ†
                } else {
                    answers.push('A'); // å…¶ä»–é€‰ä½åˆ†
                }
            }
            runTest(answers);
        }

        // é¡µé¢åŠ è½½åè‡ªåŠ¨è¿è¡Œä¸€æ¬¡æµ‹è¯•
        window.addEventListener('load', () => {
            testAllC(); // é»˜è®¤æµ‹è¯•å…¨é€‰C
        });
    </script>
</body>
</html>
