{"ast":null,"code":"// 计算维度得分\nexport function calculateDimensions(answers, questions) {\n  const scores = {\n    S: 0,\n    A: 0,\n    G: 0,\n    R: 0,\n    E: 0\n  };\n  answers.forEach(answer => {\n    const question = questions.find(q => q.id === answer.questionId);\n    if (question) {\n      const selectedOption = question.options.find(opt => opt.id === answer.selectedOption);\n      if (selectedOption && selectedOption.scores) {\n        Object.keys(selectedOption.scores).forEach(key => {\n          const dimensionKey = key;\n          const scoreValue = selectedOption.scores[dimensionKey];\n          if (scoreValue !== undefined) {\n            scores[dimensionKey] += scoreValue;\n          }\n        });\n      }\n    }\n  });\n  return scores;\n}\n\n// 将原始分值转换为0-100分制\nexport function normalizeScores(scores) {\n  const normalized = {\n    S: 0,\n    A: 0,\n    G: 0,\n    R: 0,\n    E: 0\n  };\n\n  // 40道题，每道题单个维度最高3分\n  // 每个维度大约8道题，最高约24分\n  // 调整映射范围使其更合理\n  const minScore = 0;\n  const maxScore = 24;\n  Object.keys(scores).forEach(key => {\n    const dimensionKey = key;\n    const rawScore = scores[dimensionKey];\n    // 线性映射到0-100\n    normalized[dimensionKey] = Math.round((rawScore - minScore) / (maxScore - minScore) * 100);\n    // 确保在0-100范围内\n    normalized[dimensionKey] = Math.max(0, Math.min(100, normalized[dimensionKey]));\n  });\n  return normalized;\n}\n\n// 获取维度级别\nexport function getDimensionLevel(score) {\n  if (score >= 90) return '极高';\n  if (score >= 70) return '较高';\n  if (score >= 40) return '中等';\n  if (score >= 20) return '较低';\n  return '很低';\n}\n\n// 计算两个维度配置的差异度\nexport function calculateDifference(profile1, profile2) {\n  let totalDifference = 0;\n  const dimensions = ['S', 'A', 'G', 'R', 'E'];\n  dimensions.forEach(dimension => {\n    const diff = Math.abs(profile1[dimension] - profile2[dimension]);\n    totalDifference += diff;\n  });\n  return totalDifference / dimensions.length; // 返回平均差异\n}\n\n// 计算适配度百分比\nexport function calculateCompatibility(difference) {\n  // 差异越小，适配度越高\n  // 差异为0时，适配度为100%；差异为100时，适配度为0\n  return Math.max(0, Math.round(100 - difference));\n}","map":{"version":3,"names":["calculateDimensions","answers","questions","scores","S","A","G","R","E","forEach","answer","question","find","q","id","questionId","selectedOption","options","opt","Object","keys","key","dimensionKey","scoreValue","undefined","normalizeScores","normalized","minScore","maxScore","rawScore","Math","round","max","min","getDimensionLevel","score","calculateDifference","profile1","profile2","totalDifference","dimensions","dimension","diff","abs","length","calculateCompatibility","difference"],"sources":["D:/工作文件/日常工作/开发软件/测评相关/理想伴侣测试/adapter-lover/src/utils/calculator.ts"],"sourcesContent":["import { Dimensions, UserAnswer, Question } from '../types';\r\n\r\n// 计算维度得分\r\nexport function calculateDimensions(answers: UserAnswer[], questions: Question[]): Dimensions {\r\n  const scores: Dimensions = { S: 0, A: 0, G: 0, R: 0, E: 0 };\r\n\r\n  answers.forEach(answer => {\r\n    const question = questions.find(q => q.id === answer.questionId);\r\n    if (question) {\r\n      const selectedOption = question.options.find(opt => opt.id === answer.selectedOption);\r\n      if (selectedOption && selectedOption.scores) {\r\n        Object.keys(selectedOption.scores).forEach(key => {\r\n          const dimensionKey = key as keyof Dimensions;\r\n          const scoreValue = selectedOption.scores[dimensionKey];\r\n          if (scoreValue !== undefined) {\r\n            scores[dimensionKey] += scoreValue;\r\n          }\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  return scores;\r\n}\r\n\r\n// 将原始分值转换为0-100分制\r\nexport function normalizeScores(scores: Dimensions): Dimensions {\r\n  const normalized: Dimensions = { S: 0, A: 0, G: 0, R: 0, E: 0 };\r\n\r\n  // 40道题，每道题单个维度最高3分\r\n  // 每个维度大约8道题，最高约24分\r\n  // 调整映射范围使其更合理\r\n  const minScore = 0;\r\n  const maxScore = 24;\r\n\r\n  Object.keys(scores).forEach(key => {\r\n    const dimensionKey = key as keyof Dimensions;\r\n    const rawScore = scores[dimensionKey];\r\n    // 线性映射到0-100\r\n    normalized[dimensionKey] = Math.round(((rawScore - minScore) / (maxScore - minScore)) * 100);\r\n    // 确保在0-100范围内\r\n    normalized[dimensionKey] = Math.max(0, Math.min(100, normalized[dimensionKey]));\r\n  });\r\n\r\n  return normalized;\r\n}\r\n\r\n// 获取维度级别\r\nexport function getDimensionLevel(score: number): '极高' | '较高' | '中等' | '较低' | '很低' {\r\n  if (score >= 90) return '极高';\r\n  if (score >= 70) return '较高';\r\n  if (score >= 40) return '中等';\r\n  if (score >= 20) return '较低';\r\n  return '很低';\r\n}\r\n\r\n// 计算两个维度配置的差异度\r\nexport function calculateDifference(profile1: Dimensions, profile2: Dimensions): number {\r\n  let totalDifference = 0;\r\n  const dimensions: (keyof Dimensions)[] = ['S', 'A', 'G', 'R', 'E'];\r\n\r\n  dimensions.forEach(dimension => {\r\n    const diff = Math.abs(profile1[dimension] - profile2[dimension]);\r\n    totalDifference += diff;\r\n  });\r\n\r\n  return totalDifference / dimensions.length; // 返回平均差异\r\n}\r\n\r\n// 计算适配度百分比\r\nexport function calculateCompatibility(difference: number): number {\r\n  // 差异越小，适配度越高\r\n  // 差异为0时，适配度为100%；差异为100时，适配度为0\r\n  return Math.max(0, Math.round(100 - difference));\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}