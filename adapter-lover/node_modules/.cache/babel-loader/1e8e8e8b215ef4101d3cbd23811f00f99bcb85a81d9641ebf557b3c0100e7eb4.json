{"ast":null,"code":"import { calculateDifference, calculateCompatibility } from './calculator';\nimport { getEmotionalType, generateIdealPartnerProfile, generateCompatibilityAnalysis, generatePersonalGrowthGuide, generateMeetingGuide } from './reportGenerator';\n// 生成匹配点说明\nexport function generateMatchPoints(userProfile, partnerProfile) {\n  const matchPoints = [];\n  if (Math.abs(userProfile.S - partnerProfile.S) <= 20) {\n    matchPoints.push('情感安全感需求高度匹配');\n  }\n  if (Math.abs(userProfile.A - partnerProfile.A) <= 20) {\n    matchPoints.push('个人空间需求相互尊重');\n  }\n  if (Math.abs(userProfile.G - partnerProfile.G) <= 20) {\n    matchPoints.push('共同成长理念一致');\n  }\n  if (Math.abs(userProfile.R - partnerProfile.R) <= 20) {\n    matchPoints.push('现实观念基本吻合');\n  }\n  if (Math.abs(userProfile.E - partnerProfile.E) <= 20) {\n    matchPoints.push('情感表达方式兼容');\n  }\n  return matchPoints;\n}\n\n// 生成潜在风险说明\nexport function generateRisks(userProfile, partnerProfile) {\n  const risks = [];\n  if (Math.abs(userProfile.S - partnerProfile.S) > 40) {\n    risks.push('情感安全感需求差异较大，可能产生不安全感');\n  }\n  if (Math.abs(userProfile.A - partnerProfile.A) > 40) {\n    risks.push('个人空间需求不匹配，可能出现束缚感');\n  }\n  if (Math.abs(userProfile.G - partnerProfile.G) > 40) {\n    risks.push('成长理念差异明显，对未来的规划可能冲突');\n  }\n  if (Math.abs(userProfile.R - partnerProfile.R) > 40) {\n    risks.push('现实观念差异较大，在重要决策上可能分歧');\n  }\n  if (Math.abs(userProfile.E - partnerProfile.E) > 40) {\n    risks.push('情感表达方式不同，可能出现沟通障碍');\n  }\n  return risks;\n}\n\n// 匹配伴侣类型\nexport function matchPartnerTypes(userProfile, partnerTypes) {\n  // 计算与每种类型的适配度\n  const compatibilityResults = partnerTypes.map(type => {\n    const difference = calculateDifference(userProfile, type.idealProfile);\n    const compatibility = calculateCompatibility(difference);\n    const matchPoints = generateMatchPoints(userProfile, type.idealProfile);\n    const potentialRisks = generateRisks(userProfile, type.idealProfile);\n    return {\n      type,\n      compatibility,\n      matchPoints,\n      potentialRisks\n    };\n  });\n\n  // 按适配度排序\n  compatibilityResults.sort((a, b) => b.compatibility - a.compatibility);\n  const mainType = compatibilityResults[0].type;\n  const avoidType = compatibilityResults[compatibilityResults.length - 1].type;\n  return {\n    mainType,\n    avoidType,\n    compatibilityRanking: compatibilityResults\n  };\n}\n\n// 生成完整的测评结果\nexport function generateTestResult(userProfile, dimensionLevels, partnerTypes) {\n  // 获取基础匹配结果\n  const matchingResult = matchPartnerTypes(userProfile, partnerTypes);\n\n  // 获取用户情感类型\n  const emotionalType = getEmotionalType(userProfile);\n\n  // 生成理想伴侣画像\n  const idealPartner = generateIdealPartnerProfile(matchingResult.mainType, userProfile);\n\n  // 生成匹配度分析\n  const compatibilityAnalysis = generateCompatibilityAnalysis(userProfile, matchingResult.mainType);\n\n  // 生成个人成长指南\n  const personalGrowth = generatePersonalGrowthGuide(emotionalType, userProfile);\n\n  // 生成相遇指南\n  const meetingGuide = generateMeetingGuide(matchingResult.mainType);\n  return {\n    dimensions: userProfile,\n    dimensionLevels,\n    emotionalType,\n    idealPartner,\n    compatibilityAnalysis,\n    personalGrowth,\n    meetingGuide,\n    mainType: matchingResult.mainType,\n    avoidType: matchingResult.avoidType,\n    compatibilityRanking: matchingResult.compatibilityRanking,\n    testDate: new Date()\n  };\n}","map":{"version":3,"names":["calculateDifference","calculateCompatibility","getEmotionalType","generateIdealPartnerProfile","generateCompatibilityAnalysis","generatePersonalGrowthGuide","generateMeetingGuide","generateMatchPoints","userProfile","partnerProfile","matchPoints","Math","abs","S","push","A","G","R","E","generateRisks","risks","matchPartnerTypes","partnerTypes","compatibilityResults","map","type","difference","idealProfile","compatibility","potentialRisks","sort","a","b","mainType","avoidType","length","compatibilityRanking","generateTestResult","dimensionLevels","matchingResult","emotionalType","idealPartner","compatibilityAnalysis","personalGrowth","meetingGuide","dimensions","testDate","Date"],"sources":["D:/工作文件/日常工作/开发软件/测评相关/理想伴侣测试/adapter-lover/src/utils/matcher.ts"],"sourcesContent":["import { Dimensions, PartnerType, TestResult } from '../types';\nimport { calculateDifference, calculateCompatibility } from './calculator';\nimport { getEmotionalType, generateIdealPartnerProfile, generateCompatibilityAnalysis, generatePersonalGrowthGuide, generateMeetingGuide } from './reportGenerator';\n\nexport interface CompatibilityResult {\n  type: PartnerType;\n  compatibility: number;\n  matchPoints: string[];\n  potentialRisks: string[];\n}\n\n// 生成匹配点说明\nexport function generateMatchPoints(userProfile: Dimensions, partnerProfile: Dimensions): string[] {\n  const matchPoints: string[] = [];\n\n  if (Math.abs(userProfile.S - partnerProfile.S) <= 20) {\n    matchPoints.push('情感安全感需求高度匹配');\n  }\n  if (Math.abs(userProfile.A - partnerProfile.A) <= 20) {\n    matchPoints.push('个人空间需求相互尊重');\n  }\n  if (Math.abs(userProfile.G - partnerProfile.G) <= 20) {\n    matchPoints.push('共同成长理念一致');\n  }\n  if (Math.abs(userProfile.R - partnerProfile.R) <= 20) {\n    matchPoints.push('现实观念基本吻合');\n  }\n  if (Math.abs(userProfile.E - partnerProfile.E) <= 20) {\n    matchPoints.push('情感表达方式兼容');\n  }\n\n  return matchPoints;\n}\n\n// 生成潜在风险说明\nexport function generateRisks(userProfile: Dimensions, partnerProfile: Dimensions): string[] {\n  const risks: string[] = [];\n\n  if (Math.abs(userProfile.S - partnerProfile.S) > 40) {\n    risks.push('情感安全感需求差异较大，可能产生不安全感');\n  }\n  if (Math.abs(userProfile.A - partnerProfile.A) > 40) {\n    risks.push('个人空间需求不匹配，可能出现束缚感');\n  }\n  if (Math.abs(userProfile.G - partnerProfile.G) > 40) {\n    risks.push('成长理念差异明显，对未来的规划可能冲突');\n  }\n  if (Math.abs(userProfile.R - partnerProfile.R) > 40) {\n    risks.push('现实观念差异较大，在重要决策上可能分歧');\n  }\n  if (Math.abs(userProfile.E - partnerProfile.E) > 40) {\n    risks.push('情感表达方式不同，可能出现沟通障碍');\n  }\n\n  return risks;\n}\n\n// 匹配伴侣类型\nexport function matchPartnerTypes(\n  userProfile: Dimensions,\n  partnerTypes: PartnerType[]\n): {\n  mainType: PartnerType;\n  avoidType: PartnerType;\n  compatibilityRanking: CompatibilityResult[];\n} {\n  // 计算与每种类型的适配度\n  const compatibilityResults: CompatibilityResult[] = partnerTypes.map(type => {\n    const difference = calculateDifference(userProfile, type.idealProfile);\n    const compatibility = calculateCompatibility(difference);\n    const matchPoints = generateMatchPoints(userProfile, type.idealProfile);\n    const potentialRisks = generateRisks(userProfile, type.idealProfile);\n\n    return {\n      type,\n      compatibility,\n      matchPoints,\n      potentialRisks\n    };\n  });\n\n  // 按适配度排序\n  compatibilityResults.sort((a, b) => b.compatibility - a.compatibility);\n\n  const mainType = compatibilityResults[0].type;\n  const avoidType = compatibilityResults[compatibilityResults.length - 1].type;\n\n  return {\n    mainType,\n    avoidType,\n    compatibilityRanking: compatibilityResults\n  };\n}\n\n// 生成完整的测评结果\nexport function generateTestResult(\n  userProfile: Dimensions,\n  dimensionLevels: TestResult['dimensionLevels'],\n  partnerTypes: PartnerType[]\n): TestResult {\n  // 获取基础匹配结果\n  const matchingResult = matchPartnerTypes(userProfile, partnerTypes);\n\n  // 获取用户情感类型\n  const emotionalType = getEmotionalType(userProfile);\n\n  // 生成理想伴侣画像\n  const idealPartner = generateIdealPartnerProfile(matchingResult.mainType, userProfile);\n\n  // 生成匹配度分析\n  const compatibilityAnalysis = generateCompatibilityAnalysis(userProfile, matchingResult.mainType);\n\n  // 生成个人成长指南\n  const personalGrowth = generatePersonalGrowthGuide(emotionalType, userProfile);\n\n  // 生成相遇指南\n  const meetingGuide = generateMeetingGuide(matchingResult.mainType);\n\n  return {\n    dimensions: userProfile,\n    dimensionLevels,\n    emotionalType,\n    idealPartner,\n    compatibilityAnalysis,\n    personalGrowth,\n    meetingGuide,\n    mainType: matchingResult.mainType,\n    avoidType: matchingResult.avoidType,\n    compatibilityRanking: matchingResult.compatibilityRanking,\n    testDate: new Date()\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}